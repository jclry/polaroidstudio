# 需求文档

## 介绍

目前应用在刷新页面后会丢失所有生成的拍立得照片。用户希望照片数据能够持久化保存，除非用户主动清除浏览器缓存。

## 需求

### 需求 1 - 照片数据持久化

**用户故事：** As a 用户, I want to 刷新页面后我的照片还在, so that 我可以随时回来查看我的作品。

#### 验收标准

1. **When** 用户生成一张新照片时, **the** 系统 **shall** 将该照片的所有必要信息（图片数据、位置、角度、背景色、时间戳）保存到本地存储。
2. **When** 用户拖拽移动照片结束时, **the** 系统 **shall** 更新该照片的存储位置信息。
3. **When** 用户删除照片时, **the** 系统 **shall** 从本地存储中移除对应的数据。
4. **When** 页面重新加载时, **the** 系统 **shall** 从本地存储读取所有照片数据，并按原样在画布上重建显示。

### 需求 2 - 存储容量管理

**用户故事：** As a 开发者, I want to 避免存储溢出, so that 应用保持稳定。

#### 验收标准

1. **The** 系统 **shall** 使用 `localStorage` (适合少量数据) 或 `IndexedDB` (适合大量图片数据)。考虑到图片 Base64 可能较大，**推荐使用 IndexedDB**。
2. **If** 存储空间不足, **the** 系统 **should** 提示用户或优雅降级（不保存）。

## 数据结构设计

```json
{
  "id": "unique_id",
  "imgSrc": "base64_string...",
  "bgColor": "#F8C8C0",
  "position": { "x": 100, "y": -50 },
  "rotation": 2.5,
  "timestamp": "08.25.25 14:30:00",
  "zIndex": 105
}
```

